<ion-header>
  <ion-toolbar>
    <ion-title>Ajout d'abonnement</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content>
  <form [formGroup]="signinForm" (ngSubmit)="onSubmit()">
    <ion-list>
      <ion-item>
        <ion-input
          labelPlacement="floating"
          label="Rechercher une marque :"
          [(ngModel)]="companySelected"
          (ionInput)="onInput($event)"
          #ionInputEl
          placeholder="Min 2 caractères"
          formControlName="companySelected"
          name="companySelected"
          id="companySelected"
        >
          <div
            [hidden]="!signinForm.get('companySelected')?.hasError('required')"
          >
            Ce champ est obligatoire.
          </div>
        </ion-input>
      </ion-item>
      @if (filteredOptions.length > 0) { @for (option of filteredOptions; track
      option) {
      <ion-item (click)="selectOption(option)">
        <ion-avatar slot="start">
          <img [src]="option.logo" alt="{{ option.name }} logo" />
        </ion-avatar>
        <ion-label>{{ option.name }}</ion-label>
      </ion-item>
      } }
      <ion-item>
        <ion-input
          labelPlacement="floating"
          label="Prix :"
          type="number"
          placeholder=""
          [(ngModel)]="price"
          name="price"
          formControlName="price"
        ></ion-input>
      </ion-item>
      <ion-item>
        <ion-select
          labelPlacement="floating"
          label="Catégorie :"
          [(ngModel)]="selectedCategory"
          name="selectedCategory"
          formControlName="selectedCategory"
        >
          @for (category of subscriptionCategories; track category) {
          <ion-select-option value="{{ category }}">{{
            category
          }}</ion-select-option>
          }
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-select
          labelPlacement="floating"
          label="Férquence :"
          [(ngModel)]="selectedRenewal"
          name="selectedRenewal"
          formControlName="selectedRenewal"
        >
          @for (renewal of subscriptionRenewal; track renewal) {
          <ion-select-option value="{{ renewal }}">{{
            renewal
          }}</ion-select-option>
          }
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-input
          labelPlacement="floating"
          label="Prochain paiement"
          type="text"
          placeholder="{{ selectedDate | date : 'dd.MM.YYYY' }}"
          value="{{ selectedDate | date : 'dd.MM.YYYY' }}"
          readonly
        ></ion-input>
      </ion-item>
      <ion-item class="ion-margin">
        <ion-datetime
          #datetime
          presentation="date"
          min="{{ today | date : 'YYYY-MM-dd' }}"
          max="2099-12-09"
          [(ngModel)]="nextPaymentDate"
          name="nextPaymentDate"
          formControlName="nextPaymentDate"
        >
          <ion-buttons slot="buttons">
            <ion-button color="danger" (click)="resetDateTime()"
              >Effacer</ion-button
            >
            <ion-button color="primary" (click)="selectDate()">OK</ion-button>
          </ion-buttons>
        </ion-datetime>
      </ion-item>
    </ion-list>
    <ion-grid>
      <ion-row>
        <ion-col size="6">
          <ion-button
            color="medium"
            expand="block"
            type="reset"
            (click)="resetDateTime()"
            >Effacer</ion-button
          >
        </ion-col>
        <ion-col size="6">
          <ion-button id="open-loading" expand="block" type="submit"
            >Valider</ion-button
          >
        </ion-col>
      </ion-row>
    </ion-grid>
  </form>
</ion-content>
